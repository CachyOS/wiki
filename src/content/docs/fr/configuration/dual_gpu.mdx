---
title: Guide de configuration d’un PC portable avec double GPU
---

import ImageComponent from '~/components/image-component.astro';

# Qu’est-ce que sont les graphismes hybrides?

Les graphiques hybrides sont une configuration matérielle dans laquelle vous avez deux cartes graphiques qui peuvent fonctionner en tandem l'une avec l'autre.

Cette approche se retrouve principalement dans les ordinateurs portables où vous avez un processeur graphique intégré (iGPU) à votre CPU et un processeur graphique distinct (dGPU). Le principal avantage est que le processeur graphique intégré ne doit (mais pas nécessairement) être utilisé que pour des tâches à profil bas, comme surfer sur Internet, regarder des vidéos, etc.
D'un autre côté, les processeurs graphiques distincts sont utilisés pour des tâches à hautes performances comme les jeux, le montage vidéo, la modélisation 3D, etc. Par conséquent, si deux GPU partagent des tâches « grandes » et « petites », alors si nous n'avons que des tâches « petites » en cours d'exécution en ce moment, nous n'avons pas besoin d'utiliser notre dGPU, il peut donc simplement être désactivé (comme s'il était en veille), réduisant ainsi considérablement la consommation d'énergie. De cette façon, lorsque notre dGPU est à nouveau nécessaire (nous exécutons une application en l'utilisant), il se réveillera et commencera à fonctionner.

# Qu’est-ce que PRIME Offload?

PRIME est une technologie d’unification permettant à différentes technologies graphiques hybrides de travailler ensemble sous Linux, comme les  NVIDIA Optimus/AMD Dynamic Switchable.
PRIME Offload est une l’implémentation de l'idée de déplacer l'exécution du rendu d'un GPU à un autre sous Linux. La prise en charge de PRIME dans un pilote NVIDIA fermé n'a en fait commencé qu'avec le pilote 435.17. Donc, si vous êtes un utilisateur des branches de pilotes obsolètes 390xx ou même 340xx, PRIME Offload ne fonctionnera pas pour vous. Notez que nous vous déconseillons également fortement d'utiliser des méthodes obsolètes pour gérer les graphiques hybrides, telles que nvidia-xrun ou Bumblebee. Elles sont obsolètes et non prises en charge (Bumblebee n'a pas été mis à jour depuis plus de 8 ans), fonctionnent uniquement sur des hacks et ont de faibles performances. En même temps, le pilote Nouveau prend en charge PRIME Offload, qui peut être une alternative pour les anciens dGPU.

Dans CachyOS, **vous n'avez pas besoin de configurer quoi que ce soit pour faire fonctionner PRIME Offload**. Avec le package nvidia-utils et cachyos-settings, vous avez déjà tout ce dont vous avez besoin pour utiliser PRIME Offload.

Évitez également d'utiliser des outils comme optimus-manager. Ils peuvent vous sembler très pratiques, mais croyez-nous, ils peuvent causer de nombreux problèmes et vous n'en avez vraiment pas besoin si votre dGPU prend en charge PRIME Offload et la gestion dynamique de l'alimentation.

# Comment utiliser PRIME Offload?

Pour indiquer à PRIME que vous souhaitez utiliser des processeurs graphiques discrets au lieu d'un processeur graphique intégré, vous devez spécifier un certain nombre de variables d'environnement avant d'exécuter le programme

```bash
__NV_PRIME_RENDER_OFFLOAD=1 __VK_LAYER_NV_optimus=NVIDIA_only __GLX_VENDOR_LIBRARY_NAME=nvidia <program>
```

Cet ensemble de variables semble très encombrant et facile à oublier, vous pouvez donc installer le paquet ``nvidia-prime`` (``sudo pacman -S nvidia-prime``), qui contient un alias de script pour toutes ces variables. Ensuite, l'exécution d'une application l'utilisant ressemblera à ceci :

```bash
prime-run <program>
```

Où « <programme> » est le nom de la commande qui exécute votre application.

:::note

Certains jeux DirectX 12 ont du mal à choisir le dGPU même avec `prime-run`
Pour contourner ce problème, ajoutez la variable d'environnement `VK_DRIVER_FILES=/usr/share/vulkan/icd.d/nvidia_icd.json`
avant de lancer le script  `prime-run`.
:::

